const root=document.querySelector("#root");import{loadStory,loadSection}from"./generate-html.js";import{parseText}from"./parser/if-parser.js";import{fetchFile}from"./fetch-file.js";class DOMDisplay{constructor(e){this.dom=e}removeChild(){this.dom.remove()}renderChild(){root.appendChild(this.dom)}modifyChild(e){this.dom=e}}function createCard(e){let t=document.createElement("div");return t.setAttribute("class","card"),e&&(t.innerHTML=e),t}function loadComponent(e){new DOMDisplay(e).renderChild()}function createButton(){let e=document.createElement("button");return e.innerHTML="Change display",e.addEventListener("click",e=>{loadComponent(createCard())}),e}function createDivs(){let e=document.createElement("div"),t=document.createElement("div");return e.setAttribute("class","backdrop"),t.setAttribute("class","highlights"),e.appendChild(t),e}function createTextBox(){let e=createCard(),t=createDivs(),n=document.createElement("textarea"),r=document.createElement("div");return n.setAttribute("id","input-area"),n.addEventListener("keyup",handleInput),n.addEventListener("scroll",handleScroll),n.innerHTML=localStorage.getItem("if_r-story-text")||instructions,n.spellcheck=!1,r.setAttribute("class","container"),r.appendChild(t),r.appendChild(n),e.appendChild(r),{card:e,textarea:n}}function createParsedDisplay(){let e=createCard(),t=document.createElement("div");t.setAttribute("id","if_r-output-area");let n=document.createElement("button");n.setAttribute("id","submit-btn"),n.addEventListener("click",runSubmit),n.innerHTML="Parse Text";let r=document.createElement("a");r.setAttribute("class","download-btn"),r.setAttribute("download","generate-html.js"),fetchFile("downloadable/if_r.css","css"),r.href=IF.js,r.innerHTML="Download JS";let a=document.createElement("a");a.setAttribute("class","download-btn"),a.setAttribute("download","if_r.css"),fetchFile("downloadable/if_r-terp.js","js"),a.setAttribute("href",IF.css),a.innerHTML="Download CSS";let o=document.createElement("a");o.setAttribute("class","download-btn"),o.setAttribute("download","Story.js"),o.onclick=(()=>{if(!IF.story)return console.log("Parse a story at least once.");let e=`const IF = ${JSON.stringify(IF)}`,t=new Blob([e],{type:"text/javascript"});o.setAttribute("href",window.URL.createObjectURL(t))}),o.innerHTML="Download Story";let d=document.createElement("a");return d.setAttribute("class","download-btn"),d.setAttribute("download","story-text.txt"),d.onclick=(()=>{let e=document.querySelector("#input-area").value,t=new Blob([e],{type:"text/plain"});d.setAttribute("href",window.URL.createObjectURL(t))}),d.innerHTML="Download Text",e.appendChild(n),e.appendChild(r),e.appendChild(a),e.appendChild(o),e.appendChild(d),e.appendChild(t),{card:e,div:t}}function runSubmit(){let e=parseText(document.querySelector("#input-area").value);loadStory(e),loadSection(null,IF.story.settings.startAt)}loadComponent(createTextBox().card),loadComponent(createParsedDisplay().card);